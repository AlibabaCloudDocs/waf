# 透明接入常见问题

## 同一个域名是否支持使用透明接入和CNAME接入两种模式？

不支持。

每个域名只能使用透明接入或CNAME接入两种方式之一。如果您已通过CNAME接入开启WAF防护的域名，需要切换为透明接入，您必须先删除该域名的CNAME接入配置，然后在透明接入模式下重新接入该域名。

**说明：** 域名首次透明接入WAF时，可能会导致该域名指向的网站Web业务出现秒级闪断。

## 已透明接入的域名如果无需WAF转发流量和提供防护，该如何处理？

如果您确认该域名无需WAF继续提供防护，您可以在WAF控制台**资产中心** \> **网站接入**页面的域名列表中，定位该域名所在的源站IP，删除该域名接入透明模式时绑定的所有端口、或者直接删除该域名即可。操作完成后，该域名的访问流量将切回到域名所在的源站服务器，不再通过WAF转发。

## 透明接入后，源站可以获取客户端的真实IP吗？

可以的。WAF会向域名所在的服务器直接提供真实的客户端IP，而不再将WAF的回源IP地址返回给源站服务器。

## 端口绑定的证书更新后，是否需要将证书重新上传到WAF透明接入模块中？

需要。

您可以参照以下步骤进行处理：

1.  将该更新的证书重新上传到[SSL证书控制台](https://yundunnext.console.aliyun.com/?p=cas)。相关内容请参见[上传已有证书](/cn.zh-CN/证书管理/上传已有证书.md)。
2.  将该证书重新上传到[负载均衡管理控制台](https://slb.console.aliyun.com/slb/cn-hangzhou)证书管理页面。
3.  在WAF控制台透明接入模块，单击**SLB/ALB**列表右上角![刷新](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5356623061/p175300.png)图标，同步SLB证书配置。

## 同一个域名如果配置到了多个SLB实例上，我需要如何完成透明接入？

这种情况下，您需要在对该域名进行透明接入配置时，同时添加这几个SLB实例的HTTP/HTTPS服务端口，实现WAF对这几个实例同时引流。

如果配置透明接入时，您仅添加了其中一个SLB实例的HTTP/HTTPS服务端口，WAF将仅转发来自该端口的访问流量并对其进行防护。来自其他SLB实例的流量将不会通过WAF转发和受到WAF的防护。

## 一个SLB实例配置了多个域名，如果我只对其中一个域名完成了透明接入，会有什么影响？

这种情况下，如果您只对其中一个域名进行透明接入，那么另外几个域名的访问流量会通过WAF转发，但不会受到WAF的防护。通过WAF转发的流量都会计入您消耗的业务带宽中。


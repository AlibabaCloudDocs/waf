---
keyword: [Bot管理, 爬虫威胁情报, , 阻断]
---

# 设置爬虫威胁情报规则

爬虫威胁情报功能基于云平台强大的计算能力，提供拨号池IP、IDC机房IP、恶意扫描工具IP以及云端实时模型生成的恶意爬虫库等多种维度的爬虫威胁情报规则，方便您在全域名或指定路径下设置阻断恶意爬虫的访问请求。

## 前提条件

-   已开通Web应用防火墙实例，且实例满足以下要求：

    -   使用包年包月方式开通。

        **说明：** 按量计费开通的Web应用防火墙实例暂不支持Bot管理增值服务。

    -   已开启**Bot管理**增值服务。
    更多信息，请参见[开通Web应用防火墙](/cn.zh-CN/产品定价/开通WAF/开通Web应用防火墙.md)。

-   已完成网站接入。更多信息，请参见[添加域名](/cn.zh-CN/接入WAF/CNAME接入/添加域名.md)。

## 背景信息

爬虫威胁情报规则基于阿里云爬虫情报库，帮助您阻断来自威胁情报库的爬虫请求。阿里云爬虫情报库基于阿里云全网流量和威胁情报计算得出并实时更新，可有效检测恶意爬虫IP，并提供恶意访问请求来源的特征信息。

**说明：** 阿里云爬虫情报库覆盖公有云和线下IDC网络。

您可以设置威胁情报规则，针对不同类型的威胁情报库选择不同的处置动作（例如直接拦截、进行JavaScript校验、弹出滑块验证或观察），也可以为某些关键接口配置针对特定类型威胁情报库的防护，以避免正常业务受到影响。

## 操作步骤

1.  登录[Web应用防火墙控制台](https://yundun.console.aliyun.com/?p=waf)。

2.  在顶部菜单栏，选择Web应用防火墙实例的资源组和地域（**中国内地**、**海外地区**）。

3.  在左侧导航栏，单击**防护配置** \> **网站防护**。

4.  在**网站防护**页面上方，切换到要设置的域名。

    ![切换域名](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1924559951/p77231.png)

5.  单击**Bot管理**页签，定位到**爬虫威胁情报**区域，开启**状态**开关并单击**前去配置**。

    **说明：** 爬虫威胁情报开启后，所有网站请求默认都会经过爬虫威胁情报规则的检测。您可以通过设置Bot管理白名单，让满足条件的请求忽略爬虫威胁情报规则的检测。更多信息，请参见[设置Bot管理白名单](/cn.zh-CN/网站防护配置/防护白名单/设置Bot管理白名单.md)。

    ![爬虫威胁情报](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7795359951/p96048.png)

6.  在**爬虫威胁情报**规则列表中，根据**情报名称**选择要使用的威胁情报库，开启对应的**启用状态**开关。

    ![爬虫威胁情报规则](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4395359951/p96052.png)

    下表描述了支持的爬虫威胁情报库。

    |情报库|描述|
    |---|--|
    |**扫描器恶意指纹库**|常见扫描器的特征库。|
    |**恶意扫描IP情报库**|基于阿里云全网实时检测到的恶意扫描行为攻击源IP进行分析，得到的动态IP情报库。|
    |**撞库IP情报库**|基于阿里云全网实时检测到的撞库、暴力破解行为攻击源IP进行分析，得到的动态IP情报库。|
    |**伪造蜘蛛情报库**|识别爬虫程序伪造合法搜索引擎的user-agent（如BaiduSpider）来逃避检测的行为。 **说明：** 开启该威胁情报库之前，请确保已经放行合法爬虫白名单，否则可能导致误拦截。更多信息，请参见[设置合法爬虫规则](/cn.zh-CN/网站防护配置/Bot管理/设置合法爬虫规则.md)。 |
    |**恶意爬虫情报库**|基于阿里云全网实时检测到的爬虫行为攻击源IP进行分析，得出的动态IP情报库。该名单库有低级、中级、高级三个等级。级别越高，对应的情报库内IP数量越多，相应的误判概率更大。 **说明：** 建议您对高级情报库规则设置二次校验（使用滑块验证、JS校验等处置动作）。对不适用于二次校验的场景（例如API等）配置低级别的情报库规则。 |
    |**IDC情报库**|相关公有云和IDC机房的IP库，包括：阿里云、腾讯云、美团云、世纪互联、其他。这些IP段经常被爬虫用于部署爬虫程序或用作代理，而不会被正常用户使用。|

    开启默认规则后，当目标情报库内的来源IP向域名下任意路径发起访问请求时，一律触发**观察**处置，即放行请求同时进行记录。

    如果您希望进一步调整默认规则（例如指定要防护的关键路径或者修改处置动作），请参照下一步自定义威胁情报规则。

7.  自定义威胁情报规则。

    1.  定位到要调整的默认规则，单击其操作列下的**编辑**。

    2.  在**编辑规则**对话框，完成以下规则配置。

        ![编辑规则-爬虫威胁情报](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4395359951/p96054.png)

        |参数|说明|
        |--|--|
        |**防护路径**|填写要防护的具体**URL**（例如“/abc”、“/login/abc”，“/”表示所有路径），并选择与该防护路径的**匹配方式**：         -   **精确匹配**：被访问地址与防护路径完全匹配时，会命中威胁情报规则。
        -   **前缀匹配**：被访问地址与防护路径的前缀相同时，会命中威胁情报规则。
        -   **正则匹配**：被访问地址满足防护路径的正则表达时，会命中威胁情报规则。
单击**新增防护路径**可以添加最多10个路径。 |
        |**处置动作**|指定命中规则后的操作：         -   **观察**：放行请求并进行记录。
        -   **阻断**：直接阻断访问请求。
        -   **JS验证**：通过JavaScript校验请求数据，验证通过后放行请求。
        -   **滑块**：在客户端跳出滑块验证页面，客户端完成验证后放行请求。

**说明：** 滑块验证仅支持同步请求，如有异步请求（如AJAX）防护需求请联系阿里云安全团队。如果不确定您防护的接口能否正常使用滑块验证，建议您先在自定义防护策略（ACL访问控制）中配置针对测试IP和URL的规则来验证和调试。更多信息，请参见[设置自定义防护策略](/cn.zh-CN/网站防护配置/访问控制/限流/设置自定义防护策略.md)。

        -   **严格滑块**：在客户端跳出滑块验证页面，客户端完成验证后放行请求。滑块验证的通过标准更严格。 |

    3.  单击**确定**。



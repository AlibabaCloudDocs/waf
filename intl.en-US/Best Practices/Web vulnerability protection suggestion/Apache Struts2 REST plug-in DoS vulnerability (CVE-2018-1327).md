# Apache Struts2 REST plug-in DoS vulnerability \(CVE-2018-1327\) {#concept_evj_mn4_m2b .concept}

Security experts Yevgeniy Grushka and Alvaro Munoz from HPE discovered a DoS vulnerability in the Apache Strust2 REST plug-in. The Strust REST plug-in uses the XStream library, which is vulnerable to DoS attacks launched through malicious XML requests.

## CVE number {#section_ols_mn4_m2b .section}

CVE-2018-1327

## Vulnerability name {#section_urn_xp4_m2b .section}

Apache Struts2 REST plug-in DoS vulnerability \(S2-056\)

## Description {#section_l12_zp4_m2b .section}

The S2-056 vulnerability exists in the Apache Struts2 REST plug-in. When you use the XStream handler to deserialize XML data without proper input validation, attackers can submit malicious XML data to launch DoS attacks on your application.

When malicious attackers flood your server with superfluous requests, your CPU resources can be exhausted rapidly.

For more information about this vulnerability, see the [official security bulletins](https://cwiki.apache.org/confluence/display/WW/S2-056).

## Affected versions {#section_kch_bq4_m2b .section}

Struts 2.1.1 to Struts 2.5.14.1.

## Fix {#section_ypy_bq4_m2b .section}

Upgrade to Apache Struts version 2.5.16.

## Protection tips {#section_x4q_cq4_m2b .section}

If you do not want to upgrade Apache Struts to resolve this vulnerability, we recommend that you use HTTP ACL policies and custom HTTP flood protection provided by WAF to protect your business.

-   You can add access control rules to block POST requests that contain specific XML data, such as `com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource`. This can prevent DoS attacks from exploiting this vulnerability. For example, you can add the following rule to block malicious requests sent to pages where the XStream handler is used in the Apache Strust REST plug-in.

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15591/15543772347184_en-US.png)

-   You can also use custom HTTP flood protection to restrict the frequency at which IP addresses send requests to pages where the XStream handler is used in the Apache Strust REST plug-in. For example, you can add the following rule to restrict the frequency at which requests are sent to specific pages to 100 times per 5 seconds.

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15591/15543772347185_en-US.png)


For more information about access control rules and custom HTTP flood protection, see [HTTP ACL Policy](../../../../../intl.en-US/User Guide/Configuration/HTTP ACL policy.md#) and [Custom HTTP flood protection](../../../../../intl.en-US/User Guide/Configuration/Custom HTTP flood protection.md#).


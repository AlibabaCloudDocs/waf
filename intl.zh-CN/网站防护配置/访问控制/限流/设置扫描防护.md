---
keyword: [网站防护, 访问控制/限流, 扫描防护, 高频Web攻击封禁, 目录遍历, 扫描工具, 协同防御]
---

# 设置扫描防护

网站接入Web应用防火墙后，您可以为其开启扫描防护功能。扫描防护帮助网站自动阻断包含指定特征的访问请求，例如请求源IP在短期内发起多次Web攻击或目录遍历攻击、请求源IP来自常见扫描工具或阿里云恶意扫描攻击IP库。您可以根据实际需求配置扫描防护的防护策略。

## 前提条件

-   已开通Web应用防火墙实例，且实例满足以下要求：

    -   使用包年包月方式开通：实例套餐是**高级版**及以上规格。

        如果需要自定义**高频Web攻击封禁**和**目录遍历防护**的防护策略，则实例套餐必须是**企业版**及以上规格。**高级版**及以下规格的Web应用防火墙实例只支持使用默认的防护策略开启扫描防护。更多信息，请参见[套餐规格与功能说明](/intl.zh-CN/产品简介/套餐规格与功能说明.md)。

    更多信息，请参见[开通Web应用防火墙](/intl.zh-CN/产品定价/开通WAF/开通Web应用防火墙.md)。

-   已完成网站接入。更多信息，请参见[添加域名](/intl.zh-CN/接入WAF/CNAME接入/添加域名.md)。

## 背景信息

扫描防护功能包括高频Web攻击封禁、目录遍历防护、扫描工具封禁、协同防御。

-   高频Web攻击封禁：自动封禁在短时间内发起多次Web攻击的客户端IP。支持自定义防护策略。封禁期间支持手动解封。
-   目录遍历防护：自动封禁在短时间内发起多次目录遍历攻击的客户端IP。支持自定义防护策略。封禁期间支持手动解封。
-   扫描工具封禁：自动阻断常见扫描工具IP的访问请求。支持封禁的扫描工具包括Sqlmap、AWVS、Nessus、Appscan、Webinspect、Netsparker、Nikto、Rsas等。
-   协同防御：自动阻断阿里云全球恶意扫描攻击IP库中IP的访问请求。

## 操作步骤

1.  登录[Web应用防火墙控制台](https://yundun.console.aliyun.com/?p=waf)。

2.  在顶部菜单栏，选择Web应用防火墙实例的资源组和地域（**中国内地**、**海外地区**）。

3.  在左侧导航栏，单击**防护配置** \> **网站防护**。

4.  在**网站防护**页面上方，切换到要设置的域名。

    ![切换域名](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1924559951/p77231.png)

5.  单击**访问控制/限流**页签，定位到**扫描防护**区域，完成以下功能配置。

    ![扫描防护](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1895359951/p74001.png)

    **说明：** 扫描防护下任意功能开启后，所有网站请求默认都会经过扫描防护的检测。您可以通过设置**访问控制/限流**白名单，让满足条件的请求忽略扫描防护的检测。更多信息，请参见[设置访问控制/限流白名单](/intl.zh-CN/网站防护配置/防护白名单/设置访问控制/限流白名单.md)。

    -   **高频Web攻击封禁**：开启或关闭高频Web攻击封禁。

        配置高频Web攻击封禁的防护策略

        1.  开启高频Web攻击封禁。
        2.  单击**前去配置**。
        3.  在**规则设置**对话框，配置以下参数：**检测时间范围**（秒）、**Web攻击次数超过**（次）、**封禁IP**（秒）。

            ![规则设置](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/9595359951/p73999.png)

            规则释义：如果某个客户端IP在指定的**检测时间范围**内发起的**Web攻击次数超过**指定数量，则在指定的**封禁IP**时长内阻断该IP的访问请求。

            **说明：** 建议您使用**设置参考**，单击选择一种内置的配置模式（**宽松模式**、**严格模式**、**正常模式**），并在此基础上进行调整。

        4.  单击**确定**。
        解除当前封禁IP：单击**解封当前封禁IP**，直接解除由该功能封禁的IP。

    -   **目录遍历防护**：开启或关闭目录遍历防护。

        配置目录遍历防护的防护策略

        1.  开启目录遍历防护。
        2.  单击**前去配置**。
        3.  在**规则设置**对话框，配置以下参数：**检测时间范围**（秒）、**请求总次数超过**（次）、**且404响应码占比超过**（%）、**封禁IP**（秒）、**目录数量**。

            ![规则设置](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/9595359951/p74004.png)

            规则释义：如果某个客户端IP在指定的**检测时间范围**内发起的**请求总次数超过**指定数量**且404响应码占比超过**指定比例，或者在指定的**检测时间范围**内请求访问的**目录数量**超过指定值，则在指定的**封禁IP**时长内阻断该IP的访问请求。

            **说明：** 建议您使用**设置参考**，单击选择一种内置的配置模式（**宽松模式**、**严格模式**、**正常模式**），并在此基础上进行调整。

        4.  单击**确定**。
        解除当前封禁IP：单击**解封当前封禁IP**，直接解除由该功能封禁的IP。

    -   **扫描工具封禁**：开启或关闭扫描工具封禁。

        开启后，智能识别常见的扫描工具行为。如果访问行为满足扫描特征，将一直阻断其访问请求。关闭后，将不再拦截扫描行为。

    -   **协同防御**：开启或关闭协同防御。

        开启后，自动阻断来自阿里云全球恶意扫描攻击IP库中IP的访问请求。


